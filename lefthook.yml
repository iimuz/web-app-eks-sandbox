pre-commit:
  jobs:
    - name: format
      skip:
        - rebase
        - merge
      group:
        parallel: true
        jobs:
          - name: eslint
            glob: "*.{mjs,js,jsx,ts,tsx}"
            stage_fixed: true
            run: pnpm exec eslint --fix {staged_files}
          - name: eslint - awscdk
            root: awscdk/
            glob: "*.{mjs,js,jsx,ts,tsx}"
            stage_fixed: true
            run: pnpm exec eslint --fix {staged_files}
          - name: eslint - console
            root: console/
            glob: "*.{mjs,js,jsx,ts,tsx}"
            stage_fixed: true
            run: pnpm exec eslint --fix {staged_files}
          - name: prettier
            glob: "*.{js,json,jsonc,jsonl,md,mjs,toml,ts,tsx,yml,yaml}"
            stage_fixed: true
            run: pnpm exec prettier --write {staged_files}
          - name: shfmt
            glob: "*.sh"
            stage_fixed: true
            run: shfmt -w -l {staged_files}
          - name: sort cspell file
            glob: "cspell.json"
            stage_fixed: true
            script: "sort_cspell.sh"
            runner: bash
    - name: lint
      skip:
        - rebase
        - merge
      group:
        parallel: true
        jobs:
          - name: eslint
            glob: "*.{mjs,js,jsx,ts,tsx}"
            run: pnpm exec eslint {staged_files}
          - name: eslint - awscdk
            root: awscdk/
            glob: "*.{mjs,js,jsx,ts,tsx}"
            run: pnpm exec eslint {staged_files}
          - name: eslint - console
            root: console/
            glob: "*.{mjs,js,jsx,ts,tsx}"
            run: pnpm exec eslint {staged_files}
          - name: prettier
            glob: "*.{js,json,jsonc,jsonl,md,mjs,toml,ts,tsx,yml,yaml}"
            run: pnpm exec prettier --check {staged_files}
          - name: shellcheck
            glob: "*.sh"
            run: shellcheck {staged_files}
          - name: spell check
            run: pnpm exec cspell lint --no-must-find-files --no-progress {staged_files}
          - name: tsc - awscdk
            root: awscdk/
            glob: "*.ts"
            run: npx tsc --noEmit
          - name: tsc - console
            root: console/
            glob: "*.ts"
            run: npx tsc --noEmit
